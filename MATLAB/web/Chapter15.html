<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2021a"><title>Chapter 15: The complexity of Sparse Recovery</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S1 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S2 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S3 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S4 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S6 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { color: rgb(64, 64, 64); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsErrorElement {    min-height: 18px;    max-height: 250px;    overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsWarningElement{    min-height: 18px;    max-height: 250px;    overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
/* Copyright 2015-2019 The MathWorks, Inc. *//* In this file, styles are not scoped to rtcContainer since they could be in the Dojo Tooltip */.diagnosticMessage-wrapper {    font-family: Menlo, Monaco, Consolas, "Courier New", monospace;    font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {    color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {    color: rgb(255,100,0);    text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {    color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {    color: rgb(230,0,0);    text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {    white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {    white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {    white-space: pre;    word-wrap:  initial;    min-height: 18px;    max-height: 250px;    overflow: auto;}
.textElement,.rtcDataTipElement .textElement {    padding-top: 3px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {    min-height: 16px;}
.rightPaneElement .textElement {    padding-top: 2px;    padding-left: 9px;}
.S8 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Chapter 15: The complexity of Sparse Recovery</span></h1><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S1'><span style="white-space: pre"><span >close </span><span style="color: rgb(170, 4, 249);">all</span><span >; clear </span><span style="color: rgb(170, 4, 249);">all</span><span >;</span></span></div></div></div><h2  class = 'S2'><span>Prony method: s-sparse recovery from 2s Fourier observations</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% generate an s-sparse vector together with its first 2s Fourier observations</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >N = 500;        </span><span style="color: rgb(2, 128, 9);">% ambient dimension</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >s = 10;         </span><span style="color: rgb(2, 128, 9);">% sparsity level</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >m = 2*s;        </span><span style="color: rgb(2, 128, 9);">% number of observations</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% create the sparse vector x</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >x = zeros(N,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >supp_origi = sort(randperm(N,s)); </span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >x(supp_origi) = randn(s,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% produce the observation vector y made of exact m=2s Fourier coefficients </span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >xhat = fft(x); </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >y_exact = xhat(1:m);</span></span></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% Exact recovery of the support of x via Prony method</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >phat = zeros(N,1); </span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >phat(1) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >M = toeplitz(y_exact(s:2*s-1),y_exact(s:-1:1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >phat(2:s+1) = -M\y_exact(s+1:2*s);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >p = ifft(phat);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >[~,idx] = sort(abs(p)); </span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >supp_exact = sort(idx(1:s))';</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(170, 4, 249);">'In the exact case, the original and recovered supports agree:\n'</span><span >), disp([supp_origi; supp_exact])</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="7ADCD3A3" data-scroll-top="null" data-scroll-left="null" data-testid="output_0" data-width="930" data-height="45" data-hashorizontaloverflow="false" style="width: 960px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">In the exact case, the original and recovered supports agree:
    14    28    42    87   120   201   209   229   359   499
    14    28    42    87   120   201   209   229   359   499</div></div></div></div><div class="inlineWrapper"><div  class = 'S8'></div></div></div><h2  class = 'S2'><span>Nonrobustness (hence nonstability) of Prony method</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% Adding observation noise destroys the recovery of the support</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >noise = 1e-5*rand(m,1); </span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >y_noisy = y_exact+noise;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >phat = zeros(N,1); </span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >phat(1) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >M = toeplitz(y_noisy(s:2*s-1),y_noisy(s:-1:1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >phat(2:s+1) = -M\y_noisy(s+1:2*s);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >p = ifft(phat);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >[~,idx] = sort(abs(p)); </span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >supp_noisy = sort(idx(1:s))';</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(170, 4, 249);">'In the noisy case, the original and recovered supports do not agree anymore:\n'</span><span >), disp([supp_origi; supp_noisy])</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="275B1F78" data-scroll-top="null" data-scroll-left="null" data-testid="output_1" data-width="930" data-height="45" data-hashorizontaloverflow="false" style="width: 960px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">In the noisy case, the original and recovered supports do not agree anymore:
    14    28    42    87   120   201   209   229   359   499
    40    41    87    88   120   202   209   229   359   499</div></div></div></div></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% The outputted vectors do not agree either</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >F = fft(eye(N));      </span><span style="color: rgb(2, 128, 9);">% the full discrete Fourier matrix</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >A = F(1:2*s,:);       </span><span style="color: rgb(2, 128, 9);">% the submatrix for the first 2s Fourier coefficients</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >x_exact = zeros(N,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >x_exact(supp_exact) = A(:,supp_exact)\y_exact;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >x_noisy = zeros(N,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >x_noisy(supp_noisy) = A(:,supp_noisy)\y_noisy;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >fprintf([</span><span style="color: rgb(170, 4, 249);">'Recovery from exact observations is quite successful: relative L2-error = %.2s\n'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    </span><span style="color: rgb(170, 4, 249);">'Recovery from inexact observations is not successful: relative L2-error = %.2s'</span><span >],</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >    norm(x-x_exact)/norm(x),norm(x-x_noisy)/norm(x))</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="6E69A0F0" data-scroll-top="null" data-scroll-left="null" data-testid="output_2" data-width="930" data-height="31" data-hashorizontaloverflow="false" style="width: 960px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Recovery from exact observations is quite successful: relative L2-error = 3.74e-16
Recovery from inexact observations is not successful: relative L2-error = 5.85e+00</div></div></div></div></div><h2  class = 'S2'><span>Robustness of </span><span texencoding="\ell_1" style="vertical-align:-9px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADUAAAA+CAYAAACLIVOzAAAFmUlEQVRoQ+2ZbYhUVRjH/8/dO4OZmQm+hUohoaRUsrnT3HPGthQzrFD80AtlZIFiJWLShyIzCIK+hFYUhRZG0ssHM6gUKkf2nHvd2ba2YMuIil6Uyso1k93mzr1PHLkjy7Tb3GHnrqPMgYVdzrnn+f+e/73PeVnCOdjoHGRCE+pscbXpVNOpM5iB5ut3BpNfU+imUzWlq2JwLpe7IgzDhwAIIhrPzJ7v+xsKhcL3I5l3qGcTdyqTyYy3bftZAHcRUQggz8z/AFgMoFtr7ZxVUEKIqwG8TUSXMPMu3/fXFwqFPwyElPJxAFt837+ws7Pzr3qCJeaU4zjLLMt6E8D5AB5TSj05WLiU8nYAu4IgmO553uGGhxJC3EFEOwG0GDeUUk9UipZSbmHmjVrr8fUEMnPV3SkhxI0A9hBRCsArSqnVQ4gmIcSXRHRIKbWioaGEENcA+IiIxjJzV19fn+zt7S1Wis5ms8tbWlp2B0EgPM9zGxYql8tdHoZhBxFNBHAsDMP5ruv+UCnYcZzJRPQFgANa61vrDVS312/hwoUzwjA0GZ9uJg2CYIXnee9UChZCXEBEewFM9X1/fr2rXjneiL+puXPnpidMmKCJyJRv015TSq2qBFqwYMHUdDq9G8DMMAwXeZ53KAmX6uKUEOIZItpgJmPmI0Q0Tyl1bJBgchznPsuynmbm48y8yHXdb5MCGjGUEOIWItpTFsjMy7TW75f/zmazcyzLeinaGr3Y39//SHd39/EkgUYEJaWcycyfRYXBzFUu3y1SyuuY+TYiupOZvwrDcI3neYWkYWJ/U21tbZem0+mXgyB4zvO8dwGE7e3tdqlUOgDg1L4teu3WMrNZo1YS0WQAfzPzZq31NlM7RgsollPZbNaxLGs7Ec1hZrNv+9lwENFVwwjVzPxqqVR6K6nqVi1BcaufJYS4iYjaACwF0Dpo4p+Y+Q0AB4vFotvV1fVLtaBJ98eFKuswcJ3l8s3MbFlWrqOjQycttJb5a4ISQqwlohcGBdihlLq3loCjMTY2VC6Xm8TMXwO4KCoOfw4MDMzu7u7+fTSE1hIjNpQQYhsRPViePAzDda7rDnatlrixx5qTcyqVWhcEwVbP8/rjPBgLKlqTviGidORSr9b6yiRLdXt7+zjf900SN0Vr4cSKncqwfHGhtgM4fS4KgmCp53n74mSt1jGtra1jx4wZs46IHgYwadDz9YPKZDJTbNv+sewSgL1KKbPIJtIcx9loWdanvu8ftm1bRQu5iVU/KCnlowBO3y9E56SeRIgqJpVSfhCti3WFIimlOejNiOLtU0qZxXfYJqVcyswrtdZrR/rNSSnNUWV5FKw+TpkrLiLqKhMw8/Va6/3DEUXjTf9OpdT9I3UzKajNRHTqJsjcOWitzTZpyOY4ziwics2PUmql2fg2KtQ+IloSiVujlDJno/+0qJgoAEejU22s9aQadFJOHSKi2Sa47/tTOzs7f60UksvlpoVh+HE0RpZvYKsJjtOfCJSU8giAacz8m9Z6SqUQIcTFRLSfmYulUmnxUNBxxA83JimoDwEsYuYTqVRqYj6fL5UFCCFyRPS6eeWKxeKSejpUjpEIlOM491iWtSMKssm27ed9358F4G4A5t8y7508eXJVT09P30gcGVWnTDAp5VZmfoCILGb2zXVydAJer7XelQRMok6VJ3ccZx4RSQDjiOigbduf5PP5gSSBooTWf/FNWnS1+RP5pqoFTbq/CTUow7HOU0k7MurV70wBRYUiD+Ba87s5V3V0dByNo6dhncpkMpfZtv05EZ1nQMIwXO667ul7+/+DazgoKeVqZr4BwM1lIAPAzGaTbK69vwPwlNb6xHBgDQcV5/WqNqYJVS1DjdLfdKpRnKimo+lUtQw1Sn/TqUZxopqOplPVMtQo/f8ChlFwXf6fCbsAAAAASUVORK5CYII=" width="26.5" height="31" /></span><span>-minimization</span></h2><div  class = 'S9'><span>Note that the number of observations need to be increased: Chapter 15 says that stability and robustness cannot be achieved with </span><span texencoding="m=2s
" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFwAAAAkCAYAAAAEnl30AAAE4ElEQVRoQ+2ZB6gdRRSGv9iJBQvYsICKKGrUxI4gitixtxhbTFGxa8TeC1YURGMFQcUusYsKikYFjSVGTcSGXdRYsGGXLzkLm+vu3r25l70vvDnw4HFndubMP6f858wQkjSKwJBGd0ubkQBv2AgS4AnwhhFoeLtk4QnwhhGYc7uhwDrAb8C7wJ+91iZZ+GxENwWuAzYA5guQ/wAeBI4FvuoV8AlwOBy4FpgfEOSFWsD9AdgYeL8XoA92wNcE3gBuAS4HPgWWArYErgTWCJCfB7YC/u0W9MEO+APAx8AJBUAK/HRguRhbG5iRAJ97BBYBpgHrAr+XLHM8cFWMjQTumvvtZn85mC18fWAT4KYKEA0jz8b4aODWJgBfAfgZ+Cm32dLAwsCXBQosAzj+XrfKDYDvhwFTQw/Bf65CpyWA1YHvIkw5dTXgw/w3RRbuwtsDG8bfssDywNcB5M3AbrHIucAF8b8uauIx6y8I3A/sPQBA60aFnYBH4+wrlfDyRYGJwO6AOeF7YJswULn8mHaArxo3o/usArwODAf8/WHgPmBzYAfgg8jkiwFPAG/G4kdGRs8uqs6h9wK2rjOxzZwzAalcL+RC4AzgIsB1i+Qa4GjgNOCSmGDxJPs5B7i4HeDZ+BRgRCxyKXAnYBLx1k4CrgBeDvAfAW6IQkHrnwT8Ex7xY82Tm5xcv1tZGfis20Uiv30UhmNi/aVkzU8A99wjzp1N0zDvBu6tA7ghwZhtnNY9DoubkiYpZuv9IoSoyDdRqTmmNZwOvAps1MHB9Zr1OphfNvWOCnA6WX5cnGk74JmKDzVA+bz7Hpibp9XL37McMGuojKV4+BcjWZ4SBYHhJBMLBGPaicCKwMm5sZeAzcIzdLN5UeTeGpf667lVcjVwXEwwjtsOKJUywAXZeGRMfhw4NbeC1ZcMxFBh3PZW/4rxxSNLLxCeUWUZA/UiLO2fBjQccWgnXs47ET6/BWQ2Reyt0sKfAraN7Ky75OOwrnZjaGEJ/EJOox2Bx4BfQ4GygqLdIfo5flt0C8d3oMQhOY6uEYpDoRRZuDRnZsRvM7MxOS/3APtEQdDKKqSFE8LySzct0WUgsJTLgpkdEEm/A8xnGVp25oMBL+5/UgT4LkH//o74LP/OxI6aCdI+Q1GpmzEbY3tWEtdVut8sRfq3RfDpsj64eUsGZGG3ZEtR49jbgAWQzGTfuoBfH8XLk1EA5b8zGRrbDBkWRHmqpAJ6hv1k2cZbcQCpYxbjq8DvJ0uRUei11hY+PhSJsVoP1notDA2nZ7VMvB0YFRzcwrGWhWcMZGy0LfMfnQecHR6wa8tqmWfoESpnU9+EekxdE+/TPAHUuyzWimoGCYAPE4cG3dV6jwDsrXjGvFjoWH0L/EF1APdWXov4ZQ8lH078/pXg1r6CWGEVbWb1KQ835Oxf0YnrE75zbLsnYE4yVLYTQ6lhw0cKGZwMZucgCdm3YmeRpLdah7S1cF3k/GAeukxetFrpjnF/rag48+Nas4nCJr1tgaMq3LPd4ZoYt1NoYdL6wlO2tw8SEgLFwk9gbdQZgr+ImC2j06MfKluk1+1ZlbB583kTiPVxD41xchifHUGBNpn6QFH58NxrwPuIwbyxdQK84XtKgCfAG0ag4e2ShSfAG0ag4e2ShSfAG0ag4e3+A+YV7SV6HDEzAAAAAElFTkSuQmCC" width="46" height="18" /></span><span> observations. </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% For L1-minimization, adding observation noise does not destroy the recovery </span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >m = 4*s;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >A = F(1:m,:);</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >y_exact = A*x;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >noise = 1e-5*rand(m,1); </span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >y_noisy = y_exact+noise;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >cvx_begin </span><span style="color: rgb(170, 4, 249);">quiet</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >variable </span><span style="color: rgb(170, 4, 249);">x1_exact(N)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >minimize </span><span style="color: rgb(170, 4, 249);">norm(x1_exact,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >subject </span><span style="color: rgb(170, 4, 249);">to</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >A*x1_exact == y_exact;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >cvx_end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >cvx_begin </span><span style="color: rgb(170, 4, 249);">quiet</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >variable </span><span style="color: rgb(170, 4, 249);">x1_noisy(N)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >minimize </span><span style="color: rgb(170, 4, 249);">norm(x1_noisy,1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >subject </span><span style="color: rgb(170, 4, 249);">to</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >A*x1_noisy == y_noisy;</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >cvx_end</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >fprintf([</span><span style="color: rgb(170, 4, 249);">'Recovery from exact observations is quite successful: relative L2-error = %.2s\n'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >    </span><span style="color: rgb(170, 4, 249);">'Recovery from inexact observations is not bad either: relative L2-error = %.2s'</span><span >],</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S6'><span style="white-space: pre"><span >    norm(x-x1_exact)/norm(x),norm(x-x1_noisy)/norm(x))</span></span></div><div  class = 'S7'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="94092936" data-scroll-top="null" data-scroll-left="null" data-testid="output_3" data-width="930" data-height="31" data-hashorizontaloverflow="false" style="width: 960px; max-height: 261px; white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;"><div class="textElement" style="white-space: pre; font-style: normal; color: rgb(64, 64, 64); font-size: 12px;">Recovery from exact observations is quite successful: relative L2-error = 3.26e-08
Recovery from inexact observations is not bad either: relative L2-error = 5.37e-06</div></div></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Chapter 15: The complexity of Sparse Recovery

close all; clear all;
%% Prony method: s-sparse recovery from 2s Fourier observations

% generate an s-sparse vector together with its first 2s Fourier observations
N = 500;        % ambient dimension
s = 10;         % sparsity level
m = 2*s;        % number of observations
% create the sparse vector x
x = zeros(N,1);
supp_origi = sort(randperm(N,s)); 
x(supp_origi) = randn(s,1);
% produce the observation vector y made of exact m=2s Fourier coefficients 
xhat = fft(x); 
y_exact = xhat(1:m);
%%
% Exact recovery of the support of x via Prony method
phat = zeros(N,1); 
phat(1) = 1;
M = toeplitz(y_exact(s:2*s-1),y_exact(s:-1:1));
phat(2:s+1) = -M\y_exact(s+1:2*s);
p = ifft(phat);
[~,idx] = sort(abs(p)); 
supp_exact = sort(idx(1:s))';
fprintf('In the exact case, the original and recovered supports agree:\n'), disp([supp_origi; supp_exact])

%% Nonrobustness (hence nonstability) of Prony method

% Adding observation noise destroys the recovery of the support
noise = 1e-5*rand(m,1); 
y_noisy = y_exact+noise;
phat = zeros(N,1); 
phat(1) = 1;
M = toeplitz(y_noisy(s:2*s-1),y_noisy(s:-1:1));
phat(2:s+1) = -M\y_noisy(s+1:2*s);
p = ifft(phat);
[~,idx] = sort(abs(p)); 
supp_noisy = sort(idx(1:s))';
fprintf('In the noisy case, the original and recovered supports do not agree anymore:\n'), disp([supp_origi; supp_noisy])
%%
% The outputted vectors do not agree either
F = fft(eye(N));      % the full discrete Fourier matrix
A = F(1:2*s,:);       % the submatrix for the first 2s Fourier coefficients
x_exact = zeros(N,1);
x_exact(supp_exact) = A(:,supp_exact)\y_exact;
x_noisy = zeros(N,1);
x_noisy(supp_noisy) = A(:,supp_noisy)\y_noisy;
fprintf(['Recovery from exact observations is quite successful: relative L2-error = %.2s\n',...
    'Recovery from inexact observations is not successful: relative L2-error = %.2s'],...
    norm(x-x_exact)/norm(x),norm(x-x_noisy)/norm(x))
%% Robustness of $\ell_1$-minimization
% Note that the number of observations need to be increased: Chapter 15 says 
% that stability and robustness cannot be achieved with $m=2s$ observations. 

% For L1-minimization, adding observation noise does not destroy the recovery 
m = 4*s;
A = F(1:m,:);
y_exact = A*x;
noise = 1e-5*rand(m,1); 
y_noisy = y_exact+noise;
cvx_begin quiet
variable x1_exact(N)
minimize norm(x1_exact,1)
subject to
A*x1_exact == y_exact;
cvx_end
cvx_begin quiet
variable x1_noisy(N)
minimize norm(x1_noisy,1)
subject to
A*x1_noisy == y_noisy;
cvx_end
fprintf(['Recovery from exact observations is quite successful: relative L2-error = %.2s\n',...
    'Recovery from inexact observations is not bad either: relative L2-error = %.2s'],...
    norm(x-x1_exact)/norm(x),norm(x-x1_noisy)/norm(x))
##### SOURCE END #####
-->
</div></body></html>